<!DOCTYPE html>
<html lang="en">

<head>

  <%- include("./partials/head"); -%>

</head>

<body class=" ">
  <header>
    <nav>

      <%- include("./partials/mobile-menu"); -%>

    </nav>
  </header>
  <!-- loading screen -->
  <section class=" hidden status-icons">
    <div id="loading" class="loading-text">Loading</div>
    <progress class="progress progress-info w-56" value="10" max="100"></progress>
  </section>
  <main class="card">


    <!-- TOP INFO -->
    <form id="repair-form" class="small-padding repair-form" action="#" encType="multipart/form-data">
      <legend class=" flex-col form-desc flex-center">

        <div class="  form-control  max-w-xs">
          <label class="label">
            <span class="label-text">Title: </span>
          </label>
          <input id="title" name="title" type="text" placeholder="Type here" value=<%=repair.title %> class="input
          input-bordered w-full max-w-xs" required />
          <label class="label">
          </label>
        </div>

        <div class="form-control  max-w-xs">
          <label class="label">
            <span class="label-text">Board type: </span>
          </label>
          <input id="board-type" value=<%=repair.boardType %> name="boardtype" type="text" placeholder="Type here"
          class="input input-bordered w-full max-w-xs" />
          <label class="label">
          </label>
        </div>
        <div class="form-control  max-w-xs">
          <label class="label">
            <span class="label-text">Add to Group </span>
          </label>
          <select name="groupId" class="select select-accent w-full max-w-xs">
            <option selected value=<%=repair.group %> disabled>Original value: <%=repair.group %>
            </option>
            <% groups.forEach(group=> { %>
              <option value="<%= group %>">
                <%= group %>
              </option>
              <% }) %>
                <option value='public'>Public
                </option>
          </select>
          <label class="label">
          </label>
        </div>

      </legend>


      <!-- pick parts manufacturer -->
      <section class="container w-full blue-grey darken-1">
        <fieldset class="border w-full engine-models">
          <legend>Choose Engine</legend>
          <select name="groupId" class=" w-full select select-accent w-full max-w-xs">
            <option selected value=<%=repair.engineMake %> disabled>Original value: <%=repair.engineMake %>
            </option>
            <% manufacturers.forEach(make=> { %>
              <option value="<%= make %>">
                <%= make %>
              </option>
              <% }) %>
                <option value='other'>Other
                </option>
          </select>

        </fieldset>

        <!-- <fieldset class="border engine-models">
                            <legend>Part Manufacturer</legend>
                            <span>
                                <label for="cat">
                                    <div class="badge badge-accent">
                                        <input id="cat" name="model" value="cat" type="radio" class=" model radio" />
                                    </div>
                                </label>
                            </span>
                        </fieldset> -->
      </section>


      <!-- PROCEDURES -->
      <section class=" border  ">

        <ol id="instructions" data-currentProcId="1">


          <!-- FOR LOOP -->
          <% for( let index=0, len=repair.procedureArr.length ;index < len; index++ ) { %>
            <li class=" procedure small-padding card  bg-base-100 shadow-xl" data-procedureId="1">

              <h3>Repair Procedure <%= index+1 %>
              </h3>
              <section class="grey procedure--details small-padding">

                <!-- images uploaded -->
                <fieldset class=" procedure--images-list ">
                  <legend>Images
                    <!-- add another image button -->

                  </legend>

                  <ol class="uploads" data-totalfiles="0" data-uploadId="0">
                    <!-- <li class="imageuploaded small-padding ">
                                                     <img src="" alt="repair image" class="img-mini">
                                                     <input  data-uploadnum="1" type="file" name="picture1" accept="image/*" onchange="previewImage(event)"  >
                                                     <span class="button--mobile rounded clickable">remove item</span>
                                                 </li> -->
                    <!-- FOR LOOP IMAGES -->
                    <fieldset class=" procedure--images-list ">
                      <legend>Images
                        <!-- add another image button -->

                      </legend>
                      <% repair.procedureArr[index]?.images.forEach(element=> { %>

                        <ol class="uploads" data-totalfiles="0" data-uploadid="0">
                          <!-- <li class="imageuploaded small-padding ">
                                                           <img src="" alt="repair image" class="img-mini">
                                                           <input  data-uploadnum="1" type="file" name="picture1" accept="image/*" onchange="previewImage(event)"  >
                                                           <span class="button--mobile rounded clickable">remove item</span>
                                                       </li> -->



                          <li class="card imageuploaded small-padding">
                            <img src=<%=element%> alt="image preview" class="img-mini" />
                            <input onchange="previewImage(event);" type="file" accept="image/*"><span
                              class="button--mobile clickable rounded btn" data-action="remove-image">remove item</span>
                          </li>
                        </ol>


                        <% }) %>
                    </fieldset>
                    <!-- FOR LOOP IMAGES END -->

                  </ol>
                  <div class="btn bg-warning text-black " data-action="add-image">
                    add another image
                  </div>

                </fieldset>
                <!-- <fieldset class=""> -->
                <legend class="">Instructions</legend>
                <textarea id="instructions1"
                  class="textarea textarea-warning instructions center-block large-input white"
                  placeholder="Instructions" name="instructions1" data-orig=<%=repair.procedureArr[index].instructions
                  %>
                    rows="8"><%=repair.procedureArr[index].instructions %></textarea>

              </section>
              <section class="controls">
                <div class="bg-accent text-base-200 btn add-proc" data-action="add-procedure">
                  add another step
                </div>

                <details class="warning">
                  <summary class=" btn text-black bg-warning remove-proc"> Delete Procedure</summary>
                  <div class=" btn bg-error-content text-white" data-action="remove-procedure">confirm
                    delete</div>
                </details>
              </section>
            </li>
            <% } %>
              <!-- FOR LOOP END -->

              <!-- repair instructions -->
              <li class=" procedure small-padding card  bg-base-100 shadow-xl" data-procedureId="1">

                <section class="grey procedure--details small-padding">
                  <h3>Repair Procedure</h3>


                  <!-- images uploaded -->
                  <fieldset class=" procedure--images-list ">
                    <legend>Images
                      <!-- add another image button -->

                    </legend>

                    <ol class="uploads" data-totalfiles="0" data-uploadId="0">
                      <!-- <li class="imageuploaded small-padding ">
                                                   <img src="" alt="repair image" class="img-mini">
                                                   <input  data-uploadnum="1" type="file" name="picture1" accept="image/*" onchange="previewImage(event)"  >
                                                   <span class="button--mobile rounded clickable">remove item</span>
                                               </li> -->

                    </ol>
                    <div class="btn bg-warning text-black " data-action="add-image">
                      add another image
                    </div>

                  </fieldset>
                  <!-- <fieldset class=""> -->
                  <legend class="">Instructions</legend>
                  <textarea id="instructions1"
                    class="textarea textarea-warning instructions center-block large-input white"
                    placeholder="Instructions" name="instructions1" value="" rows="8"></textarea>

                </section>
                <section class="controls">
                  <div class="bg-accent text-base-200 btn add-proc" data-action="add-procedure">
                    add another step
                  </div>

                  <details class="warning">
                    <summary class=" btn text-black bg-warning remove-proc"> Delete Procedure</summary>
                    <div class=" btn bg-error-content text-white" data-action="remove-procedure">confirm
                      delete</div>
                  </details>
                </section>
              </li>
        </ol>
      </section>
      <button id="submit" class="btn" type="submit">
        submit
      </button>

    </form>



  </main>

  <footer>

  </footer>
  <script type="text/javascript" src="/js/editpage.js"></script>
  <%- include("./partials/scripts"); -%>

</body>

</html>